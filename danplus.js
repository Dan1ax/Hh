lista de reproducción constante = {
    "estaciones": [
        {
            "season_title": "T1:Serie",
            "episodios": [
        
            {
        "title": "E1 - La conspiración",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/c750799082deb6a87ded21b117684ca6.jpg",
        "video_url": "https://od.lk/s/M18zMDk3NjQ5NTlf/Dragon%20Ball%20Daima%20Episodio%201.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMDk3NjQ5NTlf/Dragon%20Ball%20Daima%20Episodio%201.mp4",
        "duración": "32m"
    },
    {
        "título": "E2 - Glorio",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/5c008ad722a08ff67a03da61c763e0ce.jpg",
        "video_url": "https://od.lk/s/M18zMDk3NjQ5NTBf/Dragon%20Ball%20Daima%20Episodio%202.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMDk3NjQ5NTBf/Dragon%20Ball%20Daima%20Episodio%202.mp4",
        "duración": "23m"
    },
    {
        "título": "E3 - Daima",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/cd3e5a3d0b1576a58bbaa263fc58dc1e.jpg",
        "video_url": "https://od.lk/s/M18zMDk3OTkyOTdf/Dragon%20Ball%20Daima%20Episodio%203.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMDk3OTkyOTdf/Dragon%20Ball%20Daima%20Episodio%203.mp4",
        "duración": "23m"
    },
    {
        "title": "E4 - Conversadores",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/e93df1712febd0ea52d1e0b41b46dd80.jpg",
        "video_url": "https://od.lk/s/M18zMTAxMTgyODRf/Dragon%20Ball%20Daima%20Episodio%204.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTAxMTgyODRf/Dragon%20Ball%20Daima%20Episodio%204.mp4",
        "duración": "23m"
    },
    {
        "título": "E5 - Panzy",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/e8cea564d06dfb3068b59ee81bfa2e4f.jpg",
        "video_url": "https://od.lk/s/M18zMTAzMDY1MzNf/Dragon%20Ball%20Daima%20Episodio%205.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTAzMDY1MzNf/Dragon%20Ball%20Daima%20Episodio%205.mp4",
        "duración": "23m"
    },
    {
        "título": "E6 - Relámpago",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/d4f3b7d1dde8e6dc661f87e3622ebb6f.jpg",
        "video_url": "https://od.lk/s/M18zMTA0MzI0Nzlf/Dragon%20Ball%20Daima%20Episodio%206.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTA0MzI0Nzlf/Dragon%20Ball%20Daima%20Episodio%206.mp4",
        "duración": "23m"
    },
    {
        "título": "E7 - Cuello",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/31e33e4b6d3d2c585ef478d40ac1001e.jpg",
        "video_url": "https://od.lk/s/M18zMTA3OTgwMzNf/Dragon%20Ball%20Daima%20Episodio%207.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTA3OTgwMzNf/Dragon%20Ball%20Daima%20Episodio%207.mp4",
        "duración": "23m"
    },
    {
        "título": "E8 - Tamagami",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/10c92080767edcbe212570e2a801fd50.jpg",
        "video_url": "https://od.lk/s/M18zMTA3OTc2ODJf/Dragon%20Ball%20Daima%20Episodio%208.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTA3OTc2ODJf/Dragon%20Ball%20Daima%20Episodio%208.mp4",
        "duración": "23m"
    },
    {
        "título": "E9 - Ladrones",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/5b828e9c26be6db3a8ca4121d2a522f7.jpg",
        "video_url": "https://od.lk/s/M18zMTE3NDkzMjJf/Dragon%20Ball%20Daima%20Episodio%209.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTE3NDkzMjJf/Dragon%20Ball%20Daima%20Episodio%209.mp4",
        "duración": "23m"
    },
    {
        "título": "E10 - Océano",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/c5993c044460a69bc63176113609962b.jpg",
        "video_url": "https://od.lk/s/M18zMTE5MzI2MDlf/Dragon%20Ball%20Daima%20Episodio%2010.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTE5MzI2MDlf/Dragon%20Ball%20Daima%20Episodio%2010.mp4",
        "duración": "23m"
    },
    {
        "título": "E11 - Leyenda",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/f3f4fe392296c4fc23c6f5bfd731c6c8.jpg",
        "video_url": "https://od.lk/s/M18zMTIwMDg3NDdf/Dragon%20Ball%20Daima%20Episodio%2011.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTIwMDg3NDdf/Dragon%20Ball%20Daima%20Episodio%2011.mp4",
        "duración": "23m"
    },
    {
        "title": "E12 - Verdadera fuerza",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/9b70eec9c296d5f79724880cb6ebf851.jpg",
        "video_url": "https://od.lk/s/M18zMTIxMTgzODVf/Dragon%20Ball%20Daima%20episodio%2012.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTIxMTgzODVf/Dragon%20Ball%20Daima%20episodio%2012.mp4",
        "duración": "23m"
    },
    {
        "título": "E13 - Sorpresa",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/4f9fd5186ea16febf5eb0a9a8117838e.jpg",
        "video_url": "https://od.lk/s/M18zMTIzMTc1MjFf/Dragon%20Ball%20Daima%20Episodio%2013.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTIzMTc1MjFf/Dragon%20Ball%20Daima%20Episodio%2013.mp4",
        "duración": "23m"
    },
    {
        "título": "E14 - Tabú",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/4dc065e33bff32c1f7a95b3849452fe2.jpg",
        "video_url": "https://od.lk/s/M18zMTI0MTUzMDlf/Dragon%20Ball%20Daima%20Episodio%2014.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTI0MTUzMDlf/Dragon%20Ball%20Daima%20Episodio%2014.mp4",
        "duración": "23m"
    },
    {
        "título": "E15 - Tercer Ojo",
        "imagen": "https://imgsrv.crunchyroll.com/cdn-cgi/image/fit=contain,format=auto,quality=70,width=320,height=180/catalog/crunchyroll/3d87115019010e9262d7101fa02dc746.jpg",
        "video_url": "https://od.lk/s/M18zMTI0NTcyNjFf/Dragon%20Ball%20Daima%20Episodio%2015.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTI0NTcyNjFf/Dragon%20Ball%20Daima%20Episodio%2015.mp4",
        "duración": "23m"
    },
    {
        "título": "E16 - Degesu",
        "imagen": "https://od.lk/s/M18zMTI1NjY5NzRf/c6edcf601768db04c47060ea717a5626.jpg",
        "video_url": "https://od.lk/s/M18zMTI1NjY5NzBf/Dragon%20Ball%20Daima%20Episodio%2016.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTI1NjY5NzBf/Dragon%20Ball%20Daima%20Episodio%2016.mp4",
        "duración": "23m"
    },
    {
        "título": "E17 - Gomah",
        "imagen": "https://od.lk/s/M18zMTI3MDA5NTBf/13a2aae85b00a09c7a41dd25c70ee6a5%20%281%29.jpg",
        "video_url": "https://od.lk/s/M18zMTI2OTc2Nzhf/Dragon%20Ball%20Daima%20Episodio%2017.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTI2OTc2Nzhf/Dragon%20Ball%20Daima%20Episodio%2017.mp4",
        "duración": "23m"
    },
    {
        "título": "E18 - Despertar",
        "imagen": "https://od.lk/s/M18zMTM1MTA3NjBf/783c8d178b655bf66880d0fa9fd02287.jpg",
        "video_url": "https://od.lk/s/M18zMTM1MTA4MDFf/Dragon%20Ball%20Daima%20Episodio%2018.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTM1MTA4MDFf/Dragon%20Ball%20Daima%20Episodio%2018.mp4",
        "duración": "23m"
    },
    {
        "título": "E19 - Traición",
        "imagen": "https://od.lk/s/M18zMTQyNzYzODRf/d65b7d1433683e3f0fc5089df24442c3.jpg",
        "video_url": "https://od.lk/s/M18zMTQyNzYzNDdf/Dragon%20Ball%20Daima%20Episodio%2019.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTQyNzYzNDdf/Dragon%20Ball%20Daima%20Episodio%2019.mp4",
        "duración": "23m"
    },
    {
        "título": "E20 - Máximo",
        "imagen": "https://od.lk/s/M18zMTQ4MTAzNDRf/4fb9c76f8734d925bac732576cfc82ec.jpg",
        "video_url": "https://od.lk/s/M18zMTQ4Mjg0MDZf/Daima-20.1080p.AnimeYT.es.mp4",
        "enlace de descarga": "https://od.lk/d/M18zMTQ4Mjg0MDZf/Daima-20.1080p.AnimeYT.es.mp4",
        "duración": "23m"
    }
           
            ]
        }
    ]
};



  // Prevenir gestos táctiles no deseados
  document.addEventListener('touchmove', función (evento) {
            si (evento.toca.longitud > 1) {
                evento.preventDefault();
            }
        }, { pasivo: falso });


ventana.addEventListener('cargar', función () {
    constante superposición = document.querySelector('.superposición');
    const loader = document.getElementById('cargador');

    // Se mantiene el cargador visible por 1 segundo
    establecerTiempo de espera(() => {
        // Hacer que el cargador desaparezca rápidamente
        loader.style.opacity = '0'; // Desactivar loader
        establecerTiempo de espera(() => {
            loader.style.display = 'ninguno'; // eliminarlo del flujo

            // Se añade clase "hidden" al overlay para que se desvanezca lentamente
            superposición.classList.add('oculto');
        }, 300); // Tiempo de transición de 300ms para el cargador
    }, 1000); // Mantener el cargador visible durante 1 segundo

});

        const player = videojs('mi-video', {
    barra de control: {
        playToggle: false, // Eliminar el control de Play
        volumePanel: falso,
        pantalla completaAlternar: falso,
        pipToggle: falso,
        progressControl: verdadero,
        remainingTimeDisplay: verdadero,
        currentTimeDisplay: verdadero,
    },
    Acciones del usuario: {
        doubleClick: false, // Desactivar doble clic para pantalla completa
        hotkeys: false // Desactivar hotkeys para reproducción
    }
});

// Función para forzar el modo Paisaje
función forceLandscape() {
    // Verifica si el dispositivo soporta la API moderna de orientación de pantalla
    si (pantalla.orientación && pantalla.orientación.bloqueo) {
        // Intenta bloquear la orientación en Paisaje
        pantalla.orientación.lock('paisaje').catch((err) => {
            console.error('No se pudo cambiar un paisaje:', err.message);
            // Si la acción falla, intenta la compatibilidad con versiones antiguas
            fallbackToOldOrientationAPI('paisaje');
        });
    } demás {
        // Si la API moderna no está disponible, intenta con la API antigua
        fallbackToOldOrientationAPI('paisaje');
    }
}

// Función para el modo Retrato (opcional)
función forcePortrait() {
    si (pantalla.orientación && pantalla.orientación.bloqueo) {
        pantalla.orientación.lock('retrato').catch((err) => {
            console.error('No se pudo cambiar un retrato:', err.message);
            // En caso de fallo, intenta con la API antigua
            fallbackToOldOrientationAPI('retrato');
        });
    } demás {
        fallbackToOldOrientationAPI('retrato');
    }
}

// Función de compatibilidad con versiones antiguas de navegadores
función fallbackToOldOrientationAPI(modo) {
    // Verifica si el navegador soporta la API antigua
    si (ventana.pantalla.bloqueoOrientacion) {
        ventana.pantalla.bloqueoOrientación(modo).catch((err) => {
            console.error(`No se pudo cambiar a ${mode}:`, err.message);
        });
    } demás {
        console.warn('La API de orientación de pantalla no es compatible en este dispositivo.');
    }
}

// Puedes usar estas funciones en tu aplicación, por ejemplo:
// fuerzaPaisaje(); paisaje para forzar
// fuerzaRetrato(); para regresar un retrato


// Detectar el evento de reproducción del vídeo
const video = document.getElementById('mi-video');
video.addEventListener('reproducir', () => {
    fuerzaPaisaje(); // Forzar paisaje al reproducir
});

// Detectar el evento de finalización del vídeo (opcional)
video.addEventListener('finalizado', () => {
    fuerzaRetrato(); // Regresar a retrato al finalizar
});




const favoritoBtn = document.getElementById('favoritoBtn');
const favoritoIcon = document.getElementById('favoritoIcon'); // Icono
const texto favorito = document.getElementById('texto favorito'); // Texto del botón
const identificador = favoritoBtn.getAttribute('identificador-datos');

// Función para manejar el favorito
función alternarFavorito() {
    const favoritoEnlace = document.getElementById('favoritoEnlace');
    const imagen = document.getElementById('favoritoImagen');
    const nombre = document.getElementById('nombre').textContent; // Obtener el texto del span
    const favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];

    const encontrado = favoritos.some(favorito => favorito.identificador === identificador);

    si (encontrado) {
        // Eliminar de favoritos
        const nuevosFavoritos = favoritos.filter(favorito => favorito.identificador !== identificador);
        localStorage.setItem('favoritos', JSON.stringify(nuevosFavoritos));

        // Actualizar ícono y texto
        favoritoIcon.innerText = 'añadir';
        favoritoText.innerText = 'Añadir a Favoritos';

        mostrarNotificacion('Se eliminó de favoritos');
    } demás {
        // Agregar a favoritos
        favoritos.push({
            identificador: identificador,
            imagen: imagen.outerHTML,
            enlace: favoritoEnlace.href,
            nombre: nombre, // Agregar el nombre al objeto
        });
        localStorage.setItem('favoritos', JSON.stringify(favoritos));

        // Actualizar ícono y texto
        favoritoIcon.innerText = 'verificar';
        favoritoText.innerText = 'Se agregó a Favoritos';

        mostrarNotificacion('Se agregó a favoritos');
    }
}

// Función para cargar el estado inicial del botón de favoritos
function cargarEstadoFavorito() {
    const favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
    const encontrado = favoritos.some(favorito => favorito.identificador === identificador);

    si (encontrado) {
        // Si está en favoritos, actualiza el ícono y el texto
        favoritoIcon.innerText = 'verificar';
        favoritoText.innerText = 'Se agregó a Favoritos';
    } demás {
        // Si no está en favoritos, deja el ícono y texto por defecto
        favoritoIcon.innerText = 'añadir';
        favoritoText.innerText = 'Añadir a Favoritos';
    }
}

// Llamar a la función al cargar la página
document.addEventListener('DOMContentLoaded', cargarEstadoFavorito);

// Función para cargar el estado inicial del botón de favoritos
function cargarEstadoFavorito() {
    const favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
    const encontrado = favoritos.some(favorito => favorito.identificador === identificador);

    si (encontrado) {
        // Si está en favoritos, actualiza el ícono y el texto
        favoritoIcon.innerText = 'verificar';
        favoritoText.innerText = 'Se agregó a Favoritos';
    } demás {
        // Si no está en favoritos, deja el ícono y texto por defecto
        favoritoIcon.innerText = 'añadir';
        favoritoText.innerText = 'Añadir a Favoritos';
    }
}

// Llamar a la función al cargar la página
document.addEventListener('DOMContentLoaded', cargarEstadoFavorito);


// Selección de los elementos relevantes
const overlayVertical = document.querySelector('.portrait-overlay');
constante overlayHorizontal = document.querySelector('.horizontal-overlay');
const header = document.getElementById('encabezado');
const pageTitle = document.querySelector('.page-title');

// Manejar el evento de desplazamiento
ventana.addEventListener('scroll', () => {
    desplazamiento constanteY = ventana.desplazamientoY; // Obtener la posición del scroll
    desplazamiento máximo constante = 300; // Distancia máxima para el efecto completo

    // Calcular la opacidad para la superposición
    opacidad constante = Math.max(0, 1 - scrollY / maxScroll); // Rango de 1 a 0
    const titleOpacity = Math.min(scrollY / maxScroll, 1); // Rango de 0 a 1

    // Oscurecer la superposición
    si (superposiciónVertical) superposiciónVertical.style.opacidad = opacidad;
    si (superposiciónHorizontal) superposiciónHorizontal.style.opacity = opacidad;

    // Oscurecer el encabezado gradualmente
    header.style.backgroundColor = `rgba(0, 0, 0, ${1 - opacidad})`;

    // Hacer visible el título gradualmente
    pageTitle.style.opacity = opacidaddeltítulo;
});




// Función para cambiar de pestaña
función switchTab(tab) {
    const episodesTab = document.getElementById("episodios-tab");
    const otherTab = document.getElementById("otra-pestaña");
    const episodesContent = document.getElementById("episodios-contenido");
    const otherContent = document.getElementById("otro-contenido");

    // Cambiar el estado de las pestañas y el contenido correspondiente
    si (tab === 'episodios') {
        episodesTab.classList.add("activo");
        otherTab.classList.remove("activo");
        episodiosContent.classList.add("activo");
        otherContent.classList.remove("activo");
    } demás {
        episodesTab.classList.remove("activo");
        otherTab.classList.add("activo");
        episodesContent.classList.remove("activo");
        otherContent.classList.add("activo");
    }
}

// Función para cargar temporadas
función loadSeasons() {
    const seasonList = document.getElementById("lista-de-temporada");
    seasonList.innerHTML = ''; // Limpiar la lista de temporadas cada vez que se carga

    lista de reproducción.temporadas.paraCada(temporada => {
        const seasonItem = document.createElement("li");
        seasonItem.textContent = temporada.temporada_título;
        seasonItem.classList.add("elemento-de-temporada");
        seasonItem.addEventListener("hacer clic", () => loadEpisodes(temporada)); // Cargar episodios al seleccionar temporada
        seasonList.appendChild(seasonItem);
    });
}




// Función para cambiar de pestaña al hacer clic en la pestaña
document.getElementById("episodios-tab").addEventListener("clic", () => switchTab('episodios'));
document.getElementById("other-tab").addEventListener("clic", () => switchTab('other'));

// Inicialización al cargar la página
documento.addEventListener("DOMContentLoaded", () => {
    cargarEstaciones(); // Carga temporadas
    switchTab('episodios'); // Mostrar la pestaña de episodios por defecto
    document.getElementById("alternar-lista-de-temporadas").addEventListener("clic", () => {
        document.getElementById("lista-de-temporadas").classList.toggle("mostrar");
    });
});


// Crear el botón flotante de "Siguiente episodio"
const nextEpisodeButton = document.createElement('botón');
nextEpisodeButton.classList.add('vjs-boton-personalizado', 'vjs-next-episode');
nextEpisodeButton.textContent = 'Siguiente episodio';
nextEpisodeButton.style.display = 'none'; // Inicio oculto

// Temporizador de cuenta atrás
deje que el temporizador de cuenta regresiva;
dejar tiempo de cuenta regresiva = 20; // 10 segundos de cuenta atrás
let isCountdownActive = falso; // Flag para saber si la cuenta atrás está activa

// Función para mostrar el temporizador
función startCountdown() {
    nextEpisodeButton.style.display = 'bloquear'; // Muestra el botón
    tiempo de cuenta regresiva = 20; // Restablecer la cuenta atrás a 10 segundos
    actualizarCountdownDisplay(); // Actualizar el texto del temporizador

    isCountdownActive = verdadero; // Marca la cuenta atrás como activa

    // Actualizar el temporizador cada segundo
    temporizadorDeCuentaRegresiva = establecerIntervalo(() => {
        tiempoDeCuentaRegresiva--;
        actualizarCuentaRegresivaDisplay();

        si (tiempoDeCuentaRegresiva <= 0) {
            clearInterval(temporizadorDeCuentaRegresiva);
            isCountdownActive = falso; // Desactiva la cuenta atrás
            nextEpisodeButton.style.display = 'ninguno'; // El botón desaparece después de 10 segundos
            cambiarEpisodio(); // Cambiar al siguiente episodio automáticamente
        }
    }, 1000); // Cada segundo
}

// Actualizar el texto del temporizador en el botón
función updateCountdownDisplay() {
    nextEpisodeButton.textContent = `Siguiente episodio (${countdownTime}s)`;
}

// Función para cambiar al siguiente episodio
función changeEpisode() {
    // Lógica para cambiar al siguiente episodio (ajustar según tu estructura)
    si (ÍndiceDeEpisodioActual < listadereproducción.temporadas[ÍndiceDeTemporadaActual].episodios.longitud - 1) {
        índiceDeEpisodioActual++;
        const nextEpisode = playlist.seasons[ÍndiceDeTemporadaActual].episodes[ÍndiceDeEpisodioActual];
        reproductor.src({ tipo: 'video/mp4', src: nextEpisode.video_url });
        jugador.jugar();
        actualizar título (siguiente episodio); // Actualizar el título del episodio
    }
}

// Mostrar el botón "Siguiente episodio" unos minutos antes de acabar
jugador.on('actualizaciondetiempo', () => {
    const totalDuration = jugador.duration();
    const currentTime = jugador.currentTime();
    tiempo constanteBeforeEnd = 60 * 1; // 2 minutos antes de terminar

    si (duraciónTotal - tiempoActual <= tiempoAntesDeFin && !isCountdownActive) {
        iniciar cuenta regresiva(); // Comienza la cuenta atrás solo si no está activa
    }
});

// Manejo del clic en el botón para cambiar el episodio manualmente
nextEpisodeButton.addEventListener('clic', () => {
    si (isCountdownActive) {
        clearInterval(temporizador de cuenta regresiva); // Detener la cuenta atrás
    }
    cambiarEpisodio(); // Cambiar al siguiente episodio
    nextEpisodeButton.style.display = 'ninguno'; // Ocultar el botón después de hacer clic
});

// Agregar el botón de "Siguiente episodio" al reproductor
jugador.el().appendChild(botonSiguienteEpisodio);

// Restablecer el botón al inicio de cada nuevo episodio
jugador.on('loadeddata', () => {
    // Cuando se carga un episodio nuevo, reinicia el botón
    nextEpisodeButton.style.display = 'ninguno'; // Asegurarse de que el botón esté oculto al principio
    isCountdownActive = falso; // Restablecer la bandera
    clearInterval(temporizador de cuenta regresiva); // Detener cualquier temporizador activo
});




// Crear la superposición oscura
const superposición = document.createElement('div');
superposición.classList.add('vjs-dark-overlay');
jugador.el().appendChild(superposición);

// Mostrar/ocultar la superposición al tocar
dejar hideOverlayTimeout;

función showOverlay() {
    superposición.estilo.opacidad = '0,5'; // Oscurecer la pantalla
    clearTimeout(ocultarOverlayTimeout);
}

función hideOverlay() {
    superposición.estilo.opacidad = '0'; // Volver a la normalidad
}

// Eventos para oscurecer temporalmente al tocar
jugador.el().addEventListener('touchstart', () => {
    mostrarSuperposición();
    hideOverlayTimeout = setTimeout(() => {
        si (!jugador.pausado()) ocultarOverlay();
    }, 2000); // Oscurecer temporalmente durante 2 segundos
});

// Mantener la pantalla oscura al pausar
jugador.on('pausa', () => {
    mostrarSuperposición();
});

// Volver a la normalidad al reproducir
jugador.on('jugar', () => {
    ocultarSuperposición();
});


const customControls = document.createElement('div');
customControls.classList.add('vjs-controles-personalizados');

const topControls = document.createElement('div');
topControls.classList.add('vjs-top-controls');

// Botón para ajustar pantalla (solo funcional en pantalla completa en móviles)
const screenAdjustButton = document.createElement('botón');
screenAdjustButton.classList.add('vjs-boton-personalizado', 'vjs-boton-de-ajuste-de-pantalla');
screenAdjustButton.innerHTML = '<span class="material-icons">relación_de_aspecto</span>';
customControls.appendChild(botonAjustarPantalla);

// Opciones de ajuste disponibles
deje que currentAdjustmentIndex = 0;
const ajustes = ['cubrir', 'rellenar', 'ajustar-altura', 'ajustar-ancho', 'reducir', 'contener'];

// Mostrar el nombre del ajuste al centro de la pantalla
función showAdjustmentLabel(etiqueta) {
    const labelDiv = document.createElement('div');
    labelDiv.classList.add('vjs-ajuste-etiqueta');
    labelDiv.textContent = etiqueta;
    document.querySelector('.video-js').appendChild(labelDiv);

    establecerTiempo de espera(() => {
        etiquetaDiv.eliminar();
    }, 1500); // Mostrar por 1,5 segundos
}

// Lógica para cambiar los ajustes
screenAdjustButton.addEventListener('clic', () => {
    si (!jugador.isFullscreen()) {
        console.log("El control de ajuste es funcional solo en pantalla completa.");
        devolver;
    }

    currentAdjustmentIndex = (currentAdjustmentIndex + 1) % ajustes.longitud;
    const selectedAdjustment = ajustes[índiceDeAjusteActual];

    const videoElement = player.el().querySelector('video');
    const videoContainer = reproductor.el();

    interruptor (ajuste seleccionado) {
        caso 'cubierta':
            videoElement.style.objectFit = 'portada';
            romper;
        caso 'rellenar':
            videoElement.style.objectFit = 'rellenar';
            romper;
        caso 'fit-height':
            videoElement.style.objectFit = 'contener';
            videoElement.style.height = '100%';
            videoElement.style.width = 'auto';
            romper;
        caso 'ancho de ajuste':
            videoElement.style.objectFit = 'contener';
            videoElement.style.width = '100%';
            videoElement.style.height = 'auto';
            romper;
        caso 'scaledown':
            videoElement.style.objectFit = 'contener';
            videoElement.style.width = 'auto';
            videoElement.style.height = 'auto';
            videoContainer.style.display = 'flex';
            videoContainer.style.justifyContent = 'centro';
            videoContainer.style.alignItems = 'centro';
            romper;
        caso 'contiene':
            videoElement.style.objectFit = 'contener';
            videoElement.style.width = '100%';
            videoElement.style.height = '100%';
            romper;
    }

    // Mostrar el nombre del ajuste
    showAdjustmentLabel(ajuste seleccionado);
});




// Crear el botón de regreso con chevron
var backButton = document.createElement('a');
backButton.classList.add('vjs-boton-personalizado', 'vjs-boton-atrás');
backButton.innerHTML = '<span class="material-icons">chevron_left</span>';

// Agregar funcionalidad al botón
backButton.addEventListener('clic', función () {
// Pausar el video
jugador.pausa();

// Salir del modo pantalla completa si está activado
si (jugador.isFullscreen()) {
jugador.exitFullscreen();
}

// Ocultar o cerrar el reproductor (opcional, dependiendo de cómo esté configurado tu reproductor)
var playerContainer = document.getElementById('jugador');
si (contenedorJugador) {
playerContainer.style.display = 'ninguno'; // Ocultar el reproductor
}

// Restablecer orientación al salir
si (pantalla.orientación && pantalla.orientación.desbloqueo) {
pantalla.orientacion.desbloquear();
}
});

    customControls.appendChild(botonAtrás);

// Controles de Buscar y Reproducir/Pausa
const seekBackButton = document.createElement('botón');
seekBackButton.classList.add('vjs-custom-button', 'vjs-seek-back');
seekBackButton.innerHTML = '<span class="material-icons">repetición_10</span>';
topControls.appendChild(seekBackButton);

const playPauseButton = document.createElement('botón');
playPauseButton.classList.add('vjs-boton-personalizado', 'vjs-play-pause');
playPauseButton.innerHTML = '<span class="material-icons">pause</span>'; // Mostrar pausa inicialmente
topControls.appendChild(botonReproducirPausa);

const seekForwardButton = document.createElement('botón');
seekForwardButton.classList.add('vjs-boton-personalizado', 'vjs-seek-forward');
seekForwardButton.innerHTML = '<span class="material-icons">adelante_10</span>';
topControls.appendChild(seekForwardButton);

customControls.appendChild(topControls);

// Controles de Reiniciar y Next (debajo de los controles anteriores)
const bottomControls = document.createElement('div');
bottomControls.classList.add('vjs-bottom-controls');


// Botón de Reiniciar
const restartButton = document.createElement('botón');
restartButton.classList.add('vjs-custom-button', 'vjs-restart');
restartButton.innerHTML = '<span class="material-icons">skip_previous</span> Reiniciar';
bottomControls.appendChild(botonReinicio);

/// Botón siguiente
const nextButton = document.createElement('botón');
nextButton.classList.add('vjs-boton-personalizado', 'vjs-next');
nextButton.innerHTML = '<span class="material-icons">skip_next</span> Siguiente';

// Lógica para cambiar al siguiente episodio
nextButton.addEventListener('clic', () => {
    const currentEpisodeIndex = player.currentEpisodeIndex || 0; // Índice del episodio actual
    const temporada actual = lista de reproducción.temporadas[0]; // Por ahora, asumimos la primera temporada

    si (temporadaActual && temporadaActual.episodios[índiceDeEpisodioActual + 1]) {
        // Actualizar el índice del episodio actual
        const newEpisodeIndex = currentEpisodeIndex + 1;
        jugador.currentEpisodeIndex = nuevoEpisodeIndex;

        // Cambiar la fuente del video al siguiente episodio
        const nextEpisode = currentSeason.episodes[newEpisodeIndex];
        jugador.src(siguienteEpisodio.video_url);

        // Emitir un evento personalizado para actualizar otros elementos
        player.trigger('episodechange', { newEpisodeIndex });
    } demás {
        alert('No hay más episodios disponibles.');
    }
});

bottomControls.appendChild(botonSiguiente);

controles personalizados.appendChild(controles inferiores);

// Agregar los controles al reproductor
jugador.el().appendChild(customControls);

// Función para obtener el enlace de descarga del episodio actual
función getCurrentDownloadLink() {
    const currentEpisodeIndex = player.currentEpisodeIndex || 0; // Índice del episodio actual
    const temporada actual = lista de reproducción.temporadas[0]; // Por ahora, asumimos la primera temporada
    si (temporadaActual && temporadaActual.episodios[índiceDeEpisodioActual]) {
        devuelve currentSeason.episodes[currentEpisodeIndex].download_link;
    }
    devuelve nulo;
}

// Lógica para el botón de Descargar
botónDescargar.addEventListener('clic', () => {
    const enlaceDescarga = obtenerEnlaceDescargaActual();
    si (enlace de descarga) {
        const a = document.createElement('a');
        a.href = enlace de descarga;
        a.descargar = '';
        documento.cuerpo.appendChild(a);
        a.click();
        documento.cuerpo.removeChild(a);
    } demás {
        alert('No se pudo encontrar el enlace de descarga para este episodio.');
    }
});

// Actualizar el índice del episodio actual cuando cambie
player.on('cambio de episodio', (e, datos) => {
    jugador.currentEpisodeIndex = datos.newEpisodeIndex;
});



// Lógica de visibilidad de controles
deje que hideControlsTimeout;

función showControls() {
    player.controlBar.el().style.opacity = '1';
    customControls.style.opacity = '1';
    clearTimeout(ocultarControlsTimeout);
}

función hideControls() {
    si (!jugador.pausado()) {
        player.controlBar.el().style.opacity = '0';
        customControls.style.opacity = '0';
    }
}

función isMobileDevice() {
    devolver /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
}

jugador.el().addEventListener(isMobileDevice() ? 'touchstart' : 'mousemove', () => {
    mostrarControles();
    hideControlsTimeout = setTimeout(hideControls, 5000); // Ocultar controles después de 2 segundos
});

jugador.on('pausa', () => {
    mostrarControles();
    clearTimeout(ocultarControlsTimeout);
});

jugador.on('jugar', () => {
    playPauseButton.innerHTML = '<span class="material-icons">pausa</span>';
    hideControlsTimeout = setTimeout(hideControls, 2000); // Ocultar controles después de 2 segundos
});

jugador.on('pausa', () => {
    playPauseButton.innerHTML = '<span class="material-icons">flecha_de_reproducción</span>';
});

// Botones personalizados
seekBackButton.addEventListener('clic', función () {
    const currentTime = jugador.currentTime();
    jugador.tiempoActual(Math.max(0, TiempoActual - 10));
});

playPauseButton.addEventListener('clic', función () {
    si (jugador.pausado()) {
        jugador.jugar();
        playPauseButton.innerHTML = '<span class="material-icons">pausa</span>';
    } demás {
        jugador.pausa();
        playPauseButton.innerHTML = '<span class="material-icons">flecha_de_reproducción</span>';
    }
});

seekForwardButton.addEventListener('clic', función () {
    const currentTime = jugador.currentTime();
    jugador.currentTime(currentTime + 10);
});

restartButton.addEventListener('clic', función () {
    jugador.currentTime(0); // Reiniciar el vídeo
    jugador.play(); // Reproducir desde el principio
});

nextButton.addEventListener('clic', función () {
    // Verificar si hay un episodio siguiente
    si (ÍndiceDeEpisodioActual < listadereproducción.temporadas[ÍndiceDeTemporadaActual].episodios.longitud - 1) {
        // Si hay un siguiente episodio, avanzamos al siguiente episodio
        índiceDeEpisodioActual++;
        const nextEpisode = playlist.seasons[ÍndiceDeTemporadaActual].episodes[ÍndiceDeEpisodioActual];
        reproductor.src({ tipo: 'video/mp4', src: nextEpisode.video_url });
        jugador.jugar();
        actualizar título (siguiente episodio); // Actualizar el título con el nuevo episodio
    } de lo contrario si (ÍndiceDeTemporadaActual < listadereproducción.temporadas.longitud - 1) {
        // Si no hay más episodios en la temporada actual, avanzamos a la siguiente temporada
        índiceDeTemporadaActual++;
        índice de episodio actual = 0; // Comenzamos desde el primer episodio de la nueva temporada
        const nextSeason = playlist.seasons[ÍndiceActualDeTemporada];
        actualizarSeasonButton(nextSeason.season_title); // Actualizamos el título de la temporada
        cargarEpisodios(próximatemporada); // Cargamos los episodios de la siguiente temporada
        const nextEpisode = nextSeason.episodes[ÍndiceEpisodioActual];
        reproductor.src({ tipo: 'video/mp4', src: nextEpisode.video_url });
        jugador.jugar();
        actualizar título (siguiente episodio); // Actualizar el título con el nuevo episodio
    }
});


// Comportamiento de pantalla completa y pausa
jugador.on('jugar', () => {
    si (!jugador.isFullscreen()) {
        jugador.requestFullscreen();
    }
});

player.on('cambiodepantallacompleta', () => {
    si (!jugador.isFullscreen()) {
        jugador.pausa();
    }
});

// Restringir reproducción/pausa a controles personalizados
jugador.el().addEventListener('clic', (e) => {
    si (!isMobileDevice()) {
        e.stopPropagation();
    }
});

const estilo = document.createElement('estilo');
estilo.innerHTML = `
    /* Contenedores de los controles personalizados */
    .vjs-controles-personalizados {
        pantalla:flexible;
        flexión-dirección: columna;
        justificar-contenido: centro;
        alinear-elementos: centro;
        posición: absoluta;
        abajo: 10px; /* Mantener los controles Seek/Play en su lugar */
        ancho: 100%;
        índice z: 10;
    }

    /* Contenedor de los controles Seek y Play (en el centro de la pantalla) */
    .vjs-top-controls {
        pantalla:flexible;
        justificar-contenido: centro;
        alinear-elementos: centro;
        margen inferior: 10px; /* Espacio entre los controles Seek/Play y los controles de Reiniciar/Next */
        espacio: 30px; /* Añadir separación entre los controles Seek y Play */
    }

    /* Estilos para los botones de Buscar y Reproducir/Pausa (más grandes) */
    .vjs-controles-superiores .vjs-botón-personalizado {
        color de fondo: rgba(0, 0, 0, 0,);
        color: blanco;
        borde: ninguno;
        tamaño de fuente: 60px; /* Iconos más grandes */
        relleno: 20px; /* Botones más grandes */
        margen: 0 15px;
        radio del borde: 50%;
        cursor: puntero;
        transición: transformar 0,2s;
    }

    .vjs-top-controls .vjs-custom-button:hover {
        transformar: escala (1.1); /* Efecto al pasar el mouse */
    }

    .vjs-top-controls .material-icons {
        tamaño de fuente: 60px; /* Iconos más grandes */
    }

    /* Contenedor de los controles de Reiniciar y Next (debajo de los Seek/Play) */
    .vjs-bottom-controls {
        pantalla:flexible;
        justificar-contenido: centro;
        alinear-elementos: centro;
        posición: absoluta;
        abajo: -90px; /* Mover los controles Reiniciar/Next hacia abajo */
        ancho: 100%;
        espacio: 50px; /* Añadir separación entre los controles Reiniciar y Next */
    }

    /* Estilos para los botones de Reiniciar y Next (más pequeños) */
    .vjs-bottom-controls .vjs-custom-button {
        color de fondo: rgba(0, 0, 0, 0,);
        color: blanco;
        borde: ninguno;
        tamaño de fuente: 10px; /* Iconos más pequeños */
        relleno: 8px; /* Botones más pequeños */
        margen: 0 10px;
        radio del borde: 50%;
        cursor: puntero;
        transición: transformar 0,2s;
    }

    .vjs-bottom-controls .vjs-custom-button:hover {
        transformar: escala (1.1); /* Efecto al pasar el mouse */
    }

    .vjs-bottom-controls .material-icons {
        tamaño de fuente: 20px; /* Iconos más pequeños */
    }

    /* Texto pequeño al lado de los iconos */
    .vjs-reiniciar, .vjs-siguiente {
        tamaño de fuente: 10px; /* Texto más pequeño */
        margen izquierdo: 8px; /* Separación del texto respecto al icono */
    }

    /* Estilo del título */
    .vjs-título {
        posición: absoluta;
        superior: 10px;
        izquierda: 50%;
        transformar: translateX(-50%);
        tamaño de fuente: 24px;
        color: blanco;
        peso de fuente: negrita;
        sombra de texto: 2px 2px 4px rgba(0, 0, 0, 0.7);
        índice z: 9999;
    }
`;
documento.head.appendChild(estilo);




deje que currentSeasonIndex = 0;
deje que currentEpisodeIndex = 0;
let currentTitleElement = null; // Referencia al título actual

función updateTitle(episodio) {
    si (elementoDeTítuloActual) {
        elementoDeTítuloActual.remove();
    }

    const titleDiv = document.createElement('div');
    titleDiv.classList.add('vjs-title'); // Usar clase CSS
    titleDiv.textContent = episodio.título;

    documento.querySelector('.vjs-control-bar').appendChild(titleDiv);
    elementoTítuloActual = tituloDiv;
}

función loadSeasons() {
    const seasonList = document.getElementById('lista-de-temporada');
    seasonList.innerHTML = ''; // Limpiar la lista de temporadas

    lista de reproducción.temporadas.paraCada((temporada, índice) => {
        const seasonItem = document.createElement('li');
        seasonItem.textContent = temporada.temporada_título;
        seasonItem.classList.add('temporada-elemento'); // Clases para estilos

        seasonItem.onclick = () => {
            // Actualizar temporada seleccionada
            currentSeasonIndex = índice;
            índiceEpisodioactual = 0;
            renderEpisodios(temporada); // Renderizar episodios de la temporada seleccionada
            actualizarSeasonButton(temporada.temporada_título); // Actualizar el botón con el título de la temporada
            seasonList.style.display = 'ninguno'; // Ocultar lista de temporadas
        };

        seasonList.appendChild(seasonItem);
    });
}

función updateSeasonButton(seasonTitle) {
    const seasonButton = document.getElementById('alternar-lista-de-temporada');
    seasonButton.innerHTML = `<span class="material-icons">flecha desplegable</span> ${seasonTitle}`;
}

función renderEpisodes(temporada) {
    const episodeList = document.getElementById('lista-de-episodios');
    episodioList.innerHTML = ''; // Limpiar episodios anteriores

    // Obtener episodios reproducidos desde localStorage
    const episodiosvistos = JSON.parse(localStorage.getItem('episodiosvistos')) || {};

    temporada.episodios.paraCada((episodio, índice) => {
        const episodeItem = document.createElement('li');
        episodeItem.classList.add('elemento-del-episodio');

        // Marcar episodios reproducidos
        si (Episodiosvistos[episodio.video_url]?.vistos) {
            episodeItem.classList.add('visto');
        }

        // Estructura del episodio con barra de progreso
        episodeItem.innerHTML = `
            <div class="episodio">
                <div class="episode-thumbnail">
                    <img src="${episode.image}" alt="${episode.title}" class="episode-image">
                    <div class="contenedor-de-barra-de-progreso">
                        <div class="barra-de-progreso"></div>
                    </div>
                </div>
                <div class="info-del-episodio">
                    <h3 class="episode-title">${episode.title}</h3>
                    <p class="episode-duration">${episode.duration}</p>
                    <a href="${episode.download_link}" class="download_link" download="${episode.title}.mp4">
                     
                    </a>
                </div>
            </div>
        `;

        // Actualizar barra de progreso al cargar
        const barra de progreso = episodioItem.querySelector('.barra de progreso');
        const SavedTime = episodiosvistos[episodio.video_url]?.time || 0;
        const duraciónEnSegundos = parseInt(episodio.duracion.split('m')[0]) * 60;
        constante porcentajeDeProgreso = (TiempoGuardado / DuraciónEnSegundos) * 100;

        progressBar.style.width = `${progressPercentage}%`;

        // Reproducir episodio al hacer clic en el episodio (pero no en el botón de descarga)
        episodeItem.addEventListener('clic', (evento) => {
            si (evento.objetivo.más cercano('.enlace_descarga')) {
                devolver; // No hacer nada si se hizo clic en el enlace de descarga
            }

            // Solo reproducir cuando se hace clic en el episodio
            playEpisode(episodio, episodeItem, progressBar, duraciónEnSegundos, índice);
        });

        episodeList.appendChild(episodeItem);
    });

    // Cargar y mostrar el título del primer episodio por defecto
    updateTitle(temporada.episodios[0]);
}

función playEpisode(episodio, episodeItem, progressBar, duraciónEnSegundos, episodeIndex) {
    // Establecer el video
    reproductor.src({ tipo: 'video/mp4', src: episodio.video_url });

    // Obtener el progreso guardado de localStorage
    const episodiosvistos = JSON.parse(localStorage.getItem('episodiosvistos')) || {};
    const SavedTime = episodiosvistos[episodio.video_url]?.time || 0;
    const seen = seenEpisodes[episode.video_url]?.watched || false;

    // Si el episodio ya fue completado, la barra de progreso se establece al 100%
    si (miró) {
        progressBar.style.width = '100%';
    } demás {
        // Si no ha sido completado, use el tiempo guardado para mostrar el progreso
        progressBar.style.width = `${(tiempoAhorrado / duraciónEnSegundos) * 100}%`;
    }

    // Establecer el tiempo de inicio del video (para que empezar desde donde se dejó)
    jugador.currentTime(tiempoguardado);

    // Reproducir el episodio
    jugador.jugar();
    currentEpisodeIndex = índiceDeEpisodio;
    actualizar título (episodio); // Actualizar título del episodio

    // Escuchar evento de 'timeupdate' para actualizar el progreso
    jugador.on('actualizaciondetiempo', función () {
        const currentTime = jugador.currentTime();
        constante porcentajeDeProgreso = (TiempoActual / DuraciónEnSegundos) * 100;

        // Actualizar visualmente la barra de progreso
        progressBar.style.width = `${progressPercentage}%`;

        // Guardar el progreso actual de este episodio en localStorage
        episodiosvistos[episodio.video_url] = {
            tiempo: horaactual,
            visto: falso, // Por ahora, el episodio no está marcado como visto
        };
        localStorage.setItem('Episodios vistos', JSON.stringify(Episodios vistos));
    });

    // Marcar como reproducido al finalizar el vídeo
    player.on('finalizado', función () {
        const episodiosvistos = JSON.parse(localStorage.getItem('episodiosvistos')) || {};
        episodiosvistos[episodio.video_url] = {
            tiempo: duraciónEnSeconds, // Marcar como completado (100%)
            visto: verdadero, // Marcar el episodio como visto
        };
        localStorage.setItem('Episodios vistos', JSON.stringify(Episodios vistos));

        // Llenar la barra de progreso al 100% al terminar el episodio
        progressBar.style.width = '100%';

        // Marcar visualmente el episodio como visto
        episodeItem.classList.add('visto');

        // Reproducir automáticamente el episodio siguiente
        autoReproducciónSiguienteEpisodio();
    });
}


función autoPlayNextEpisode() {
    const currentSeason = playlist.seasons[currentSeasonIndex];
    si (ÍndiceDeEpisodioActual < TemporadaActual.episodios.longitud - 1) {
        // Avanzar al siguiente episodio
        índiceDeEpisodioActual++;
        const nextEpisode = currentSeason.episodes[ÍndiceEpisodeActual];

        // Obtener elementos del siguiente episodio
        const episodeList = document.getElementById('lista-de-episodios');
        const nextEpisodeItem = episodeList.children[ÍndiceDeEpisodioActual];
        const nextProgressBar = nextEpisodeItem.querySelector('.progress-bar');
        constante nextDurationInSeconds = parseInt(nextEpisode.duration.split('m')[0]) * 60;

        // Reproducir el siguiente episodio
        playEpisode(siguienteEpisodio, siguienteElementoDeEpisodio, siguienteBarraDeProgreso, siguienteDuraciónEnSegundos, índiceDeEpisodioActual);
    } de lo contrario si (ÍndiceDeTemporadaActual < listadereproducción.temporadas.longitud - 1) {
        // Avanzar a la siguiente temporada
        índiceDeTemporadaActual++;
        índiceEpisodioactual = 0;
        const nextSeason = playlist.seasons[ÍndiceActualDeTemporada];
        updateSeasonButton(próximaTemporada.temporada_título);
        renderEpisodios(próximaTemporada);
        const nextEpisode = nextSeason.episodes[ÍndiceEpisodioActual];

        // Obtener elementos del siguiente episodio
        const episodeList = document.getElementById('lista-de-episodios');
        const nextEpisodeItem = episodeList.children[ÍndiceDeEpisodioActual];
        const nextProgressBar = nextEpisodeItem.querySelector('.progress-bar');
        constante nextDurationInSeconds = parseInt(nextEpisode.duration.split('m')[0]) * 60;

        // Reproducir el siguiente episodio
        playEpisode(siguienteEpisodio, siguienteElementoDeEpisodio, siguienteBarraDeProgreso, siguienteDuraciónEnSegundos, índiceDeEpisodioActual);
    }
}

// Inicializar la lista de temporadas
cargarTemporadas();

// Inicializar la aplicación al cargar la página
documento.addEventListener('DOMContentLoaded', () => {
    cargarEstaciones(); // Cargar temporadas en la lista
    renderEpisodios(lista de reproducción.temporadas[0]); // Descargar episodios de la primera temporada
    updateSeasonButton(playlist.seasons[0].season_title); // Botón con la primera temporada
    // No reproducir automáticamente al cargar la página
});

// Cargar el progreso de cada episodio desde localStorage cuando se recarga la página
documento.addEventListener('DOMContentLoaded', función () {
    const episodiosvistos = JSON.parse(localStorage.getItem('episodiosvistos')) || {};

    // Recorre todos los episodios y actualiza la barra de progreso según el tiempo guardado
    const episodeList = document.getElementById('lista-de-episodios');
    Array.from(episodeList.children).forEach((episodeItem, index) => {
        const episode = playlist.seasons[currentSeasonIndex].episodes[índice];
        const barra de progreso = episodioItem.querySelector('.barra de progreso');
        const SavedTime = episodiosvistos[episodio.video_url]?.time || 0;
        const duraciónEnSegundos = parseInt(episodio.duracion.split('m')[0]) * 60;

        // Si el episodio está marcado como visto, la barra debe estar al 100%
        si (Episodiosvistos[episodio.video_url]?.vistos) {
            progressBar.style.width = '100%';
        } demás {
            progressBar.style.width = `${(tiempoAhorrado / duraciónEnSegundos) * 100}%`;
        }
    });
});




// Gestión de imágenes de perfil
const footerProfileIcon = document.getElementById("footerIconImg");
const imagenPerfil = document.getElementById("imagenPerfil");
const perfilPageImage = document.getElementById("perfilPageImage");

const defaultProfileIcon = document.getElementById("defaultProfileIcon"); // Icono de perfil en el pie de página
const defaultProfileIconAlt = document.getElementById("defaultProfileIconAlt"); // Icono alternativo de perfil

// Función para cambiar todas las imágenes de perfil
función updateProfileImage(src) {
  perfilImage.src = src;
  perfilPageImage.src = src;
  pie de páginaIconoPerfil.src = src;
  defaultProfileIcon.style.display = 'ninguno'; // Ocultar el icono de perfil
  defaultProfileIconAlt.style.display = 'ninguno'; // Ocultar el icono alternativo
  localStorage.setItem('profileImage', src); // Guardar la imagen en el almacenamiento local
}

// Restaurar la imagen de perfil guardada al cargar la página
ventana.addEventListener('cargar', función () {
  const almacenadaImagenPerfil = localStorage.getItem('imagenPerfil');
  si (imagenPerfilAlmacenada) {
    footerProfileIcon.src = imagenPerfilAlmacenada;
    profileImage.src = imagenPerfilAlmacenada;
    profilePageImage.src = imagenPerfilAlmacenada;
    defaultProfileIcon.style.display = 'ninguno'; // Ocultar el icono de perfil
    defaultProfileIconAlt.style.display = 'ninguno'; // Ocultar el icono alternativo
  }
});